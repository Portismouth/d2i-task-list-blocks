!function(){"use strict";var e,t={63:function(e,t,l){var a=window.wp.blocks,n=window.wp.element,s=window.wp.i18n,i=window.wp.blockEditor,o=window.wp.data,r=window.wp.components,d=window.wp.apiFetch,c=l.n(d);function u(e){let{task:t,index:l,toggleTaskEdit:a}=e;const i=(0,o.useDispatch)("d2i/tasks"),d=i&&i.editTask,c=(0,n.useRef)(),[u,k]=(0,n.useState)(t.title),[m,p]=(0,n.useState)(t.taskType),[h,b]=(0,n.useState)(t.documentLink),[f,C]=(0,n.useState)(!1);return(0,n.createElement)("form",{className:"addtodo-form",onSubmit:async e=>{if(e.preventDefault(),d&&u){const e={title:u,schoolId:t.schoolId,folder:t.folder,taskType:t.taskType,isCompleted:"0",id:t.id};h&&(e.documentLink=h),C(!0);const n=await d(e);n.task.isEdit=t.isEdit,k(""),p(""),b(),C(!1),a(n.task,l)}}},(0,n.createElement)(r.TextControl,{ref:c,label:(0,s.__)("Task name","d2i-task-list-blocks"),value:u,onChange:e=>k(e)}),(0,n.createElement)(r.RadioControl,{selected:m,label:(0,s.__)("Document Type","d2i-task-list-blocks"),help:(0,s.__)("Whether this doc is an upload or link to download","d2i-task-list-blocks"),options:[{label:"Upload",value:"upload"},{label:"External Link",value:"external_link"}],onChange:e=>{b(),"external_link"===e&&b({title:"",url:""}),p(e)}}),"external_link"===m&&(0,n.createElement)(n.Fragment,null,(0,n.createElement)(r.TextControl,{label:(0,s.__)("Link Title","d2i-task-list-blocks"),value:h?h.title:null,onChange:e=>{const t={...h};t.title=e,b(t)}}),(0,n.createElement)(r.TextControl,{label:(0,s.__)("Link URL","d2i-task-list-blocks"),value:h?h.url:null,onChange:e=>{const t={...h};t.url=e,b(t)}})),(0,n.createElement)(r.Button,{disabled:f,type:"submit",isPrimary:!0},(0,s.__)("Save Changes","todo-list")),(0,n.createElement)(r.Button,{disabled:f,onClick:()=>a(t,l),variant:"tertiary"},(0,s.__)("Cancel","todo-list")))}var k=JSON.parse('{"u2":"d2i-blocks/task-item"}');(0,a.registerBlockType)(k.u2,{edit:function(e){let{attributes:t,setAttributes:l,context:a}=e;const d=a["d2i-task-list/schoolId"],{directoryName:k}=t,[m,p]=(0,n.useState)(""),[h,b]=(0,n.useState)(""),[f,C]=(0,n.useState)(),[E,_]=(0,n.useState)(!1),[v,y]=(0,n.useState)({tasks:[]}),[g,w]=(0,n.useState)(!1),T=(0,n.useRef)(),x=(0,o.useDispatch)("d2i/tasks"),S=x&&x.addTask,L=x&&x.deleteTask;(0,n.useEffect)((()=>{0!==d&&k?c()({path:`/d2i-task-list/v1/task-items/${d}?directoryName=${k}`}).then((e=>{e.length>0?(y({tasks:e}),w(!0)):c()({path:`/d2i-task-list/v1/task-items/by-folder?directoryName=${k}`}).then((e=>{y({tasks:e}),e.length<1&&w(!0)}))})):k&&0===d&&c()({path:`/d2i-task-list/v1/task-items/by-folder?directoryName=${k}`}).then((e=>{y({tasks:e}),e.length<1&&w(!0)}))}),[k]),(0,n.useEffect)((()=>{l({directoryName:k})}),[null,k]);const N=(e,t)=>{e.isEdit=!e.isEdit;const l=[...v.tasks];l[t]={...e},y({tasks:l})};return(0,n.createElement)("div",(0,i.useBlockProps)(),(0,n.createElement)(i.RichText,{placeholder:(0,s.__)("Folder Name","team-member"),tagName:"h2",onChange:e=>{l({directoryName:e})},value:k,allowedFormats:[]}),!v.tasks||v.tasks.length<1&&(0,n.createElement)(r.Card,null,(0,n.createElement)(r.CardBody,null,(0,n.createElement)("p",null,(0,s.__)("Please add some tasks using the form below","d2i-task-list-blocks")))),v.tasks&&(0,n.createElement)(n.Fragment,null,(0,n.createElement)(r.Card,null,(0,n.createElement)(r.CardHeader,{size:"xSmall"},(0,n.createElement)(n.Fragment,null,"Tasks",!g&&(0,n.createElement)(r.Button,{disabled:E||0===d||!d,onClick:()=>{const e=v.tasks.map((e=>{const t={...e,schoolId:d,directoryName:k};return e.documentLink&&(t.documentLink=e.documentLink),t}));c()({path:"/d2i-task-list/v1/task-items/confirm-new",method:"POST",data:e}).then((e=>{y({tasks:e}),v.tasks&&w(!0)}))},isPrimary:!0},(0,s.__)("Confirm New Tasks","d2i-task-list-blocks")))),(0,n.createElement)(r.CardBody,null,(0,n.createElement)("ul",null,v.tasks.map(((e,t)=>(0,n.createElement)("li",{key:t,className:("1"===e.isCompleted||!0===e.isCompleted)&&"is-completed"},!e.isEdit&&(0,n.createElement)(n.Fragment,null,(0,n.createElement)(r.CheckboxControl,{disabled:e.loading,label:e.title,checked:"1"===e.isCompleted||!0===e.isCompleted,onChange:()=>{((e,t)=>{"1"===e.isCompleted?e.isCompleted="0":"0"===e.isCompleted?e.isCompleted="1":!0===e.isCompleted?e.isCompleted=!1:e.isCompleted=!0;const l=[...v.tasks];l[t]={...e,isCompleted:e.isCompleted},c()({path:`/d2i-task-list/v1/task-items/${e.id}`,method:"POST",data:l[t]}).then((()=>{y({tasks:l})}))})(e,t)},className:"task-check-control"}),e.documentLink&&(0,n.createElement)(r.ExternalLink,{href:e.documentLink.url,target:e.documentLink.target},e.documentLink.title),(0,n.createElement)(r.Button,{disabled:E||"1"===e.isCompleted||!0===e.isCompleted,onClick:()=>N(e,t),variant:"secondary",isSmall:!0},(0,s.__)("Edit","d2i-task-list-blocks")),(0,n.createElement)(r.Button,{disabled:"1"===e.isCompleted||!0===e.isCompleted,onClick:()=>(async(e,t)=>{await L(e,t);const l=[...v.tasks];l.splice(t,1),y({tasks:l})})(e,t),isDestructive:!0,variant:"tertiary",isSmall:!0},(0,s.__)("Delete","d2i-task-list-blocks"))),e.isEdit&&(0,n.createElement)(u,{task:e,index:t,toggleTaskEdit:N}))))))),(0,n.createElement)(r.Card,null,(0,n.createElement)(r.CardHeader,{size:"xSmall"},"New Tasks"),(0,n.createElement)(r.CardBody,null,(0,n.createElement)("form",{onSubmit:async e=>{if(e.preventDefault(),S&&m){const e={title:m,schoolId:d,directoryName:k,newTaskType:h,isCompleted:"0"};f&&(e.documentLink=f),_(!0);const t=await S(e);p(""),b(""),C(),y({tasks:[...v.tasks,t.task]}),_(!1),T.current.focus()}},className:"addtodo-form"},(0,n.createElement)(r.TextControl,{ref:T,label:(0,s.__)("Task name","d2i-task-list-blocks"),value:m,onChange:e=>p(e)}),(0,n.createElement)(r.RadioControl,{selected:h,label:(0,s.__)("Document Type","d2i-task-list-blocks"),help:(0,s.__)("Whether this doc is an upload or link to download","d2i-task-list-blocks"),options:[{label:"Upload",value:"upload"},{label:"External Link",value:"external_link"}],onChange:e=>{C(),"external_link"===e&&C({title:"",url:""}),b(e)}}),"external_link"===h&&(0,n.createElement)(n.Fragment,null,(0,n.createElement)(r.TextControl,{label:(0,s.__)("Link Title","d2i-task-list-blocks"),value:f.title,onChange:e=>{const t={...f};t.title=e,C(t)}}),(0,n.createElement)(r.TextControl,{label:(0,s.__)("Link URL","d2i-task-list-blocks"),value:f.url,onChange:e=>{const t={...f};t.url=e,C(t)}})),(0,n.createElement)(r.Button,{disabled:E,type:"submit",isPrimary:!0},(0,s.__)("Add Task","todo-list")))))))},save:function(){return null}})}},l={};function a(e){var n=l[e];if(void 0!==n)return n.exports;var s=l[e]={exports:{}};return t[e](s,s.exports,a),s.exports}a.m=t,e=[],a.O=function(t,l,n,s){if(!l){var i=1/0;for(c=0;c<e.length;c++){l=e[c][0],n=e[c][1],s=e[c][2];for(var o=!0,r=0;r<l.length;r++)(!1&s||i>=s)&&Object.keys(a.O).every((function(e){return a.O[e](l[r])}))?l.splice(r--,1):(o=!1,s<i&&(i=s));if(o){e.splice(c--,1);var d=n();void 0!==d&&(t=d)}}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[l,n,s]},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,{a:t}),t},a.d=function(e,t){for(var l in t)a.o(t,l)&&!a.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={428:0,720:0};a.O.j=function(t){return 0===e[t]};var t=function(t,l){var n,s,i=l[0],o=l[1],r=l[2],d=0;if(i.some((function(t){return 0!==e[t]}))){for(n in o)a.o(o,n)&&(a.m[n]=o[n]);if(r)var c=r(a)}for(t&&t(l);d<i.length;d++)s=i[d],a.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return a.O(c)},l=self.webpackChunkd2i_task_list_blocks=self.webpackChunkd2i_task_list_blocks||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var n=a.O(void 0,[720],(function(){return a(63)}));n=a.O(n)}();